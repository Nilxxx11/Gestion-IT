<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gesti√≥n IT - Neil Pereira</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --light: #f8fafc;
            --dark: #1e293b;
            --background: #f1f5f9;
            --card-bg: #ffffff;
            --border: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), #1e40af);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background-color: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background-color: #f1f5f9;
        }

        .nav-tab.active {
            background-color: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .card h3 {
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, var(--primary), #1e40af);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .metric-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .metric-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 250px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
        }

        .btn {
            padding: 12px 25px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background-color: #1e40af;
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: #475569;
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-success:hover {
            background-color: #059669;
        }

        .hidden {
            display: none;
        }

        .search-bar {
            margin-bottom: 20px;
        }

        .search-bar input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background-color: #f8fafc;
            font-weight: 600;
        }

        tr:hover {
            background-color: #f1f5f9;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .edit-btn {
            background-color: var(--info);
            color: white;
        }

        .delete-btn {
            background-color: var(--danger);
            color: white;
        }

        .view-btn {
            background-color: var(--success);
            color: white;
        }

        .password-container {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--secondary);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-modal {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary);
        }

        .password-strength {
            height: 5px;
            margin-top: 8px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .strength-weak {
            background-color: var(--danger);
            width: 33%;
        }

        .strength-medium {
            background-color: var(--warning);
            width: 66%;
        }

        .strength-strong {
            background-color: var(--success);
            width: 100%;
        }

        .category-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .category-email {
            background-color: #e0f2fe;
            color: #0369a1;
        }

        .category-social {
            background-color: #fce7f3;
            color: #be185d;
        }

        .category-work {
            background-color: #dcfce7;
            color: #15803d;
        }

        .category-finance {
            background-color: #fef3c7;
            color: #b45309;
        }

        .category-other {
            background-color: #e5e7eb;
            color: #374151;
        }

        .file-manager {
            background-color: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .file-manager-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }

            .form-row {
                flex-direction: column;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .file-manager-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-laptop-code"></i> Sistema Neil Pereira</h1>
            <p>Gesti√≥n Integral de Activos IT y Contrase√±as</p>
        </div>

        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showTab('dashboard')"><i class="fas fa-tachometer-alt"></i> Dashboard</div>
            <div class="nav-tab" onclick="showTab('assets')"><i class="fas fa-desktop"></i> Activos</div>
            <div class="nav-tab" onclick="showTab('incidents')"><i class="fas fa-exclamation-circle"></i> Incidentes</div>
            <div class="nav-tab" onclick="showTab('reports')"><i class="fas fa-chart-bar"></i> Reportes</div>
            <div class="nav-tab" onclick="showTab('maintenance')"><i class="fas fa-tools"></i> Mantenimiento</div>
            <div class="nav-tab" onclick="showTab('passwords')"><i class="fas fa-key"></i> Contrase√±as</div>
            <div class="nav-tab" onclick="showTab('backup')"><i class="fas fa-database"></i> Respaldo</div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard-grid">
                <div class="metric-card">
                    <div class="metric-number" id="totalAssets">0</div>
                    <div class="metric-label">Activos Totales</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" id="activeIncidents">0</div>
                    <div class="metric-label">Incidentes Activos</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" id="expiredLicenses">0</div>
                    <div class="metric-label">Licencias Vencidas</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" id="maintenanceDue">0</div>
                    <div class="metric-label">Mantenimientos Pendientes</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number" id="totalPasswords">0</div>
                    <div class="metric-label">Contrase√±as Guardadas</div>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-chart-pie"></i> Resumen de Incidentes por √Årea</h3>
                <div class="chart-container">
                    <canvas id="incidentsChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-chart-line"></i> Tendencia de Incidentes</h3>
                <div class="chart-container">
                    <canvas id="incidentsTrendChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-exclamation-triangle"></i> Alertas Importantes</h3>
                <div id="alertsContainer">
                    <!-- Las alertas se cargar√°n din√°micamente -->
                </div>
            </div>
        </div>
        <!-- Assets Tab -->
        <div id="assets" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-desktop"></i> Gesti√≥n de Activos</h3>
                <form id="assetForm">
                    <input type="hidden" id="assetId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="assetName">Nombre del Activo</label>
                            <input type="text" id="assetName" required>
                        </div>
                        <div class="form-group">
                            <label for="assetType">Tipo</label>
                            <select id="assetType" required>
                                <option value="">Seleccionar</option>
                                <option value="Hardware">Hardware</option>
                                <option value="Software">Software</option>
                                <option value="Licencia">Licencia</option>
                                <option value="Perif√©rico">Perif√©rico</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="assetArea">√Årea</label>
                            <select id="assetArea" required>
                                <option value="">Seleccionar</option>
                                <option value="Administraci√≥n">Administraci√≥n</option>
                                <option value="Compras">Compras</option>
                                <option value="Contabilidad">Contabilidad</option>
                                <option value="RRHH">RRHH</option>
                                <option value="Gerencia">Gerencia</option>
                                <option value="SGI">SGI</option>
                                <option value="Almacen">Almacen</option>
                                <option value="Mantenimiento">Mantenimiento</option>
                                <option value="Operaciones">Operaciones</option>
                                <option value="Sistemas">Sistemas</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="assetSerial">N√∫mero de Serie</label>
                            <input type="text" id="assetSerial">
                        </div>
                        <div class="form-group">
                            <label for="assetPurchaseDate">Fecha de Compra</label>
                            <input type="date" id="assetPurchaseDate">
                        </div>
                        <div class="form-group">
                            <label for="assetWarranty">Garant√≠a Hasta</label>
                            <input type="date" id="assetWarranty">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="assetNotes">Notas</label>
                        <textarea id="assetNotes" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn" id="assetSubmitBtn"><i class="fas fa-plus"></i> Agregar Activo</button>
                    <button type="button" class="btn btn-secondary" onclick="clearAssetForm()"><i class="fas fa-broom"></i> Limpiar</button>
                    <button type="button" class="btn btn-danger hidden" id="assetCancelBtn" onclick="cancelAssetEdit()"><i class="fas fa-times"></i> Cancelar</button>
                </form>
            </div>

            <div class="card">
                <h3><i class="fas fa-list"></i> Lista de Activos</h3>
                <div class="search-bar">
                    <input type="text" id="assetSearch" placeholder="Buscar activos..." onkeyup="filterAssets()">
                </div>
                <div class="table-container">
                    <table id="assetsTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Tipo</th>
                                <th>√Årea</th>
                                <th>Serie</th>
                                <th>Garant√≠a</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="assetsTableBody">
                            <!-- Los datos se cargar√°n din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Incidents Tab -->
        <div id="incidents" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-exclamation-circle"></i> Registro de Incidentes</h3>
                <form id="incidentForm">
                    <input type="hidden" id="incidentId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="incidentTitle">T√≠tulo del Incidente</label>
                            <input type="text" id="incidentTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="incidentArea">√Årea Afectada</label>
                            <select id="incidentArea" required>
                              <option value="">Seleccionar</option>
                              <option value="Administraci√≥n">Administraci√≥n</option>
                              <option value="Compras">Compras</option>
                              <option value="Contabilidad">Contabilidad</option>
                              <option value="RRHH">RRHH</option>
                              <option value="Gerencia">Gerencia</option>
                              <option value="SGI">SGI</option>
                              <option value="Almacen">Almacen</option>
                              <option value="Mantenimiento">Mantenimiento</option>
                              <option value="Operaciones">Operaciones</option>
                              <option value="Sistemas">Sistemas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="incidentType">Tipo de Problema</label>
                            <select id="incidentType" required>
                                <option value="">Seleccionar</option>
                                <option value="Hardware">Hardware</option>
                                <option value="Software">Software</option>
                                <option value="Red">Red</option>
                                <option value="Email">Email</option>
                                <option value="Impresora">Impresora</option>
                                <option value="Sistema">Sistema</option>
                                <option value="Usuario">Usuario</option>
                                <option value="Otro">Otro</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="incidentPriority">Prioridad</label>
                            <select id="incidentPriority" required>
                                <option value="">Seleccionar</option>
                                <option value="Baja">Baja</option>
                                <option value="Media">Media</option>
                                <option value="Alta">Alta</option>
                                <option value="Cr√≠tica">Cr√≠tica</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="incidentReporter">Reportado por</label>
                            <input type="text" id="incidentReporter" required>
                        </div>
                        <div class="form-group">
                            <label for="incidentStatus">Estado</label>
                            <select id="incidentStatus" required>
                                <option value="Abierto">Abierto</option>
                                <option value="En Progreso">En Progreso</option>
                                <option value="Resuelto">Resuelto</option>
                                <option value="Cerrado">Cerrado</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="incidentDescription">Descripci√≥n</label>
                        <textarea id="incidentDescription" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="incidentResolution">Resoluci√≥n</label>
                        <textarea id="incidentResolution" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn" id="incidentSubmitBtn"><i class="fas fa-plus"></i> Registrar Incidente</button>
                    <button type="button" class="btn btn-secondary" onclick="clearIncidentForm()"><i class="fas fa-broom"></i> Limpiar</button>
                    <button type="button" class="btn btn-danger hidden" id="incidentCancelBtn" onclick="cancelIncidentEdit()"><i class="fas fa-times"></i> Cancelar</button>
                </form>
            </div>

            <div class="card">
                <h3><i class="fas fa-list"></i> Lista de Incidentes</h3>
                <div class="search-bar">
                    <input type="text" id="incidentSearch" placeholder="Buscar incidentes..." onkeyup="filterIncidents()">
                </div>
                <div class="table-container">
                    <table id="incidentsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>T√≠tulo</th>
                                <th>√Årea</th>
                                <th>Tipo</th>
                                <th>Prioridad</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="incidentsTableBody">
                            <!-- Los datos se cargar√°n din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-chart-bar"></i> Generaci√≥n de Reportes</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="reportType">Tipo de Reporte</label>
                        <select id="reportType">
                            <option value="assets">Inventario de Activos</option>
                            <option value="incidents">Reporte de Incidentes</option>
                            <option value="incidents_by_area">Incidentes por √Årea</option>
                            <option value="incidents_by_type">Incidentes por Tipo</option>
                            <option value="warranty_status">Estado de Garant√≠as</option>
                            <option value="maintenance_schedule">Programaci√≥n de Mantenimiento</option>
                            <option value="passwords">Contrase√±as Guardadas</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="reportPeriod">Per√≠odo</label>
                        <select id="reportPeriod">
                            <option value="all">Todo el tiempo</option>
                            <option value="last_week">√öltima semana</option>
                            <option value="last_month">√öltimo mes</option>
                            <option value="last_quarter">√öltimo trimestre</option>
                            <option value="last_year">√öltimo a√±o</option>
                        </select>
                    </div>
                </div>
                <button onclick="generateReport()" class="btn"><i class="fas fa-file-alt"></i> Generar Reporte</button>
                <button onclick="exportToExcel()" class="btn btn-secondary"><i class="fas fa-file-excel"></i> Exportar a Excel</button>
            </div>

            <div class="card">
                <h3><i class="fas fa-chart-pie"></i> Estad√≠sticas de Incidentes</h3>
                <div class="chart-container">
                    <canvas id="reportsChart"></canvas>
                </div>
            </div>

            <div class="card" id="reportResults">
                <h3><i class="fas fa-list-alt"></i> Resultados del Reporte</h3>
                <div id="reportContent">
                    <p>Selecciona un tipo de reporte y haz clic en "Generar Reporte" para ver los resultados.</p>
                </div>
            </div>
        </div>

        <!-- Maintenance Tab -->
        <div id="maintenance" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-tools"></i> Programaci√≥n de Mantenimiento</h3>
                <form id="maintenanceForm">
                    <input type="hidden" id="maintenanceId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="maintenanceAsset">Activo</label>
                            <select id="maintenanceAsset" required>
                                <option value="">Seleccionar activo</option>
                                <!-- Se llenar√° din√°micamente -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="maintenanceType">Tipo de Mantenimiento</label>
                            <select id="maintenanceType" required>
                                <option value="">Seleccionar</option>
                                <option value="Preventivo">Preventivo</option>
                                <option value="Correctivo">Correctivo</option>
                                <option value="Predictivo">Predictivo</option>
                                <option value="Emergencia">Emergencia</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="maintenanceDate">Fecha Programada</label>
                            <input type="date" id="maintenanceDate" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="maintenanceDescription">Descripci√≥n</label>
                        <textarea id="maintenanceDescription" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="maintenanceStatus">Estado</label>
                        <select id="maintenanceStatus" required>
                            <option value="Programado">Programado</option>
                            <option value="En Progreso">En Progreso</option>
                            <option value="Completado">Completado</option>
                            <option value="Cancelado">Cancelado</option>
                        </select>
                    </div>
                    <button type="submit" class="btn" id="maintenanceSubmitBtn"><i class="fas fa-plus"></i> Programar Mantenimiento</button>
                    <button type="button" class="btn btn-secondary" onclick="clearMaintenanceForm()"><i class="fas fa-broom"></i> Limpiar</button>
                    <button type="button" class="btn btn-danger hidden" id="maintenanceCancelBtn" onclick="cancelMaintenanceEdit()"><i class="fas fa-times"></i> Cancelar</button>
                </form>
            </div>

            <div class="card">
                <h3><i class="fas fa-list"></i> Cronograma de Mantenimiento</h3>
                <div class="search-bar">
                    <input type="text" id="maintenanceSearch" placeholder="Buscar mantenimientos..." onkeyup="filterMaintenance()">
                </div>
                <div class="table-container">
                    <table id="maintenanceTable">
                        <thead>
                            <tr>
                                <th>Activo</th>
                                <th>Tipo</th>
                                <th>Fecha</th>
                                <th>Estado</th>
                                <th>Descripci√≥n</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="maintenanceTableBody">
                            <!-- Los datos se cargar√°n din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Passwords Tab -->
        <div id="passwords" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-key"></i> Administrador de Contrase√±as</h3>
                <form id="passwordForm">
                    <input type="hidden" id="passwordId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="passwordPlatform">Plataforma/Servicio</label>
                            <input type="text" id="passwordPlatform" required placeholder="Ej: Gmail, Facebook, Windows">
                        </div>
                        <div class="form-group">
                            <label for="passwordUsername">Usuario/Email</label>
                            <input type="text" id="passwordUsername" required>
                        </div>
                        <div class="form-group">
                            <label for="passwordCategory">Categor√≠a</label>
                            <select id="passwordCategory" required>
                                <option value="">Seleccionar</option>
                                <option value="email">Email</option>
                                <option value="social">Redes Sociales</option>
                                <option value="work">Trabajo</option>
                                <option value="finance">Finanzas</option>
                                <option value="entertainment">Entretenimiento</option>
                                <option value="other">Otro</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="passwordValue">Contrase√±a</label>
                            <div class="password-container">
                                <input type="password" id="passwordValue" required>
                                <span class="toggle-password" onclick="togglePasswordVisibility('passwordValue')">
                                    <i class="fas fa-eye"></i>
                                </span>
                            </div>
                            <div id="passwordStrength" class="password-strength"></div>
                        </div>
                        <div class="form-group">
                            <label for="passwordUrl">URL (opcional)</label>
                            <input type="url" id="passwordUrl" placeholder="https://...">
                        </div>
                        <div class="form-group">
                            <label for="passwordGenerate">Generar Contrase√±a Segura</label>
                            <button type="button" class="btn btn-secondary" onclick="generateSecurePassword()" style="width:100%">
                                <i class="fas fa-key"></i> Generar
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="passwordNotes">Notas (opcional)</label>
                        <textarea id="passwordNotes" rows="2" placeholder="Informaci√≥n adicional..."></textarea>
                    </div>
                    <button type="submit" class="btn" id="passwordSubmitBtn"><i class="fas fa-save"></i> Guardar Contrase√±a</button>
                    <button type="button" class="btn btn-secondary" onclick="clearPasswordForm()"><i class="fas fa-broom"></i> Limpiar</button>
                    <button type="button" class="btn btn-danger hidden" id="passwordCancelBtn" onclick="cancelPasswordEdit()"><i class="fas fa-times"></i> Cancelar</button>
                </form>
            </div>

            <div class="card">
                <h3><i class="fas fa-list"></i> Contrase√±as Guardadas</h3>
                <div class="form-row">
                    <div class="form-group">
                        <input type="text" id="passwordSearch" placeholder="Buscar contrase√±as..." onkeyup="filterPasswords()">
                    </div>
                    <div class="form-group">
                        <select id="passwordCategoryFilter" onchange="filterPasswords()">
                            <option value="">Todas las categor√≠as</option>
                            <option value="email">Email</option>
                            <option value="social">Redes Sociales</option>
                            <option value="work">Trabajo</option>
                            <option value="finance">Finanzas</option>
                            <option value="entertainment">Entretenimiento</option>
                            <option value="other">Otro</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table id="passwordsTable">
                        <thead>
                            <tr>
                                <th>Plataforma</th>
                                <th>Usuario</th>
                                <th>Categor√≠a</th>
                                <th>Contrase√±a</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="passwordsTableBody">
                            <!-- Los datos se cargar√°n din√°micamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- Backup Tab -->
        <div id="backup" class="tab-content">
            <div class="card">
                <h3><i class="fas fa-database"></i> Gesti√≥n de Respaldos</h3>
                <div class="file-manager">
                    <h4><i class="fas fa-save"></i> Guardar datos en archivos locales</h4>
                    <p>Guarda toda la informaci√≥n del sistema en archivos JSON en tu computadora.</p>
                    <div class="file-manager-buttons">
                        <button class="btn" onclick="saveAllData()"><i class="fas fa-download"></i> Guardar Todo</button>
                        <button class="btn btn-secondary" onclick="saveAssetsToFile()"><i class="fas fa-desktop"></i> Guardar Activos</button>
                        <button class="btn btn-secondary" onclick="saveIncidentsToFile()"><i class="fas fa-exclamation-circle"></i> Guardar Incidentes</button>
                        <button class="btn btn-secondary" onclick="saveMaintenanceToFile()"><i class="fas fa-tools"></i> Guardar Mantenimiento</button>
                        <button class="btn btn-secondary" onclick="savePasswordsToFile()"><i class="fas fa-key"></i> Guardar Contrase√±as</button>
                    </div>
                </div>

                <div class="file-manager">
                    <h4><i class="fas fa-upload"></i> Cargar datos desde archivos</h4>
                    <p>Carga informaci√≥n desde archivos JSON previamente guardados.</p>
                    <div class="file-manager-buttons">
                        <button class="btn" onclick="document.getElementById('loadFileInput').click()"><i class="fas fa-upload"></i> Cargar Archivo</button>
                        <input type="file" id="loadFileInput" accept=".json" style="display: none;" onchange="loadFromFile(this.files[0])">
                    </div>
                </div>

                <div class="file-manager">
                    <h4><i class="fas fa-folder-open"></i> Archivos guardados recientemente</h4>
                    <div id="recentFiles">
                        <p>No hay archivos recientes</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resto de las pesta√±as (Assets, Incidents, Reports, Maintenance, Passwords) -->
        <!-- ... (el contenido de estas pesta√±as permanece igual que en el c√≥digo anterior) ... -->

    </div>

    <!-- Modal for Master Key -->
    <div id="masterKeyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-lock"></i> Clave Maestra</h3>
                <span class="close-modal" onclick="closeModal('masterKeyModal')">&times;</span>
            </div>
            <p>Para acceder a las contrase√±as, debe establecer una clave maestra. Esta clave se utilizar√° para encriptar y desencriptar sus contrase√±as.</p>
            <div class="form-group">
                <label for="masterKeyInput">Clave Maestra</label>
                <input type="password" id="masterKeyInput" required>
            </div>
            <div class="form-group">
                <label for="masterKeyConfirm">Confirmar Clave Maestra</label>
                <input type="password" id="masterKeyConfirm" required>
            </div>
            <button onclick="setMasterKey()" class="btn"><i class="fas fa-key"></i> Establecer Clave</button>
        </div>
    </div>

    <!-- Modal for Enter Master Key -->
    <div id="enterMasterKeyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-lock"></i> Ingresar Clave Maestra</h3>
                <span class="close-modal" onclick="closeModal('enterMasterKeyModal')">&times;</span>
            </div>
            <p>Ingrese su clave maestra para acceder a las contrase√±as.</p>
            <div class="form-group">
                <label for="enterMasterKeyInput">Clave Maestra</label>
                <input type="password" id="enterMasterKeyInput" required>
            </div>
            <button onclick="verifyMasterKey()" class="btn"><i class="fas fa-unlock"></i> Desbloquear</button>
        </div>
    </div>

    <script>
        // Datos de la aplicaci√≥n
        let assets = [];
        let incidents = [];
        let maintenance = [];
        let passwords = [];
        let masterKey = null;
        let recentFiles = [];

        // Inicializar la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            loadAllData();
            loadDashboardData();
            loadAssetsTable();
            loadIncidentsTable();
            loadMaintenanceTable();
            loadPasswordsTable();
            loadRecentFiles();

            // Configurar event listeners para los formularios
            document.getElementById('assetForm').addEventListener('submit', handleAssetSubmit);
            document.getElementById('incidentForm').addEventListener('submit', handleIncidentSubmit);
            document.getElementById('maintenanceForm').addEventListener('submit', handleMaintenanceSubmit);
            document.getElementById('passwordForm').addEventListener('submit', handlePasswordSubmit);

            // Configurar validaci√≥n de fortaleza de contrase√±a
            document.getElementById('passwordValue').addEventListener('input', checkPasswordStrength);
        });

        // ==================== SISTEMA DE ARCHIVOS LOCAL ====================

        function saveAllData() {
            const data = {
                assets: assets,
                incidents: incidents,
                maintenance: maintenance,
                passwords: passwords,
                masterKey: masterKey,
                timestamp: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            saveAs(blob, `sistema_gestion_backup_${formatDateForFilename(new Date())}.json`);
            addRecentFile(`sistema_gestion_backup_${formatDateForFilename(new Date())}.json`);
        }

        function saveAssetsToFile() {
            const blob = new Blob([JSON.stringify(assets, null, 2)], { type: 'application/json' });
            saveAs(blob, `activos_${formatDateForFilename(new Date())}.json`);
            addRecentFile(`activos_${formatDateForFilename(new Date())}.json`);
        }

        function saveIncidentsToFile() {
            const blob = new Blob([JSON.stringify(incidents, null, 2)], { type: 'application/json' });
            saveAs(blob, `incidentes_${formatDateForFilename(new Date())}.json`);
            addRecentFile(`incidentes_${formatDateForFilename(new Date())}.json`);
        }

        function saveMaintenanceToFile() {
            const blob = new Blob([JSON.stringify(maintenance, null, 2)], { type: 'application/json' });
            saveAs(blob, `mantenimiento_${formatDateForFilename(new Date())}.json`);
            addRecentFile(`mantenimiento_${formatDateForFilename(new Date())}.json`);
        }

        function savePasswordsToFile() {
            if (!masterKey) {
                alert('Primero debe establecer una clave maestra');
                showModal('masterKeyModal');
                return;
            }

            const data = {
                passwords: passwords,
                timestamp: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            saveAs(blob, `contrase√±as_${formatDateForFilename(new Date())}.json`);
            addRecentFile(`contrase√±as_${formatDateForFilename(new Date())}.json`);
        }

        function loadFromFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);

                    if (data.assets) {
                        assets = data.assets;
                        localStorage.setItem('assets', JSON.stringify(assets));
                    }

                    if (data.incidents) {
                        incidents = data.incidents;
                        localStorage.setItem('incidents', JSON.stringify(incidents));
                    }

                    if (data.maintenance) {
                        maintenance = data.maintenance;
                        localStorage.setItem('maintenance', JSON.stringify(maintenance));
                    }

                    if (data.passwords) {
                        passwords = data.passwords;
                        localStorage.setItem('passwords', JSON.stringify(passwords));
                    }

                    if (data.masterKey) {
                        masterKey = data.masterKey;
                        localStorage.setItem('masterKey', masterKey);
                    }

                    // Recargar todas las tablas
                    loadDashboardData();
                    loadAssetsTable();
                    loadIncidentsTable();
                    loadMaintenanceTable();
                    loadPasswordsTable();

                    alert('Datos cargados correctamente desde el archivo');
                    addRecentFile(file.name);
                } catch (error) {
                    alert('Error al cargar el archivo: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function loadAllData() {
            // Cargar datos desde localStorage como respaldo
            try {
                assets = JSON.parse(localStorage.getItem('assets')) || [];
                incidents = JSON.parse(localStorage.getItem('incidents')) || [];
                maintenance = JSON.parse(localStorage.getItem('maintenance')) || [];
                passwords = JSON.parse(localStorage.getItem('passwords')) || [];
                masterKey = localStorage.getItem('masterKey');
                recentFiles = JSON.parse(localStorage.getItem('recentFiles')) || [];
            } catch (e) {
                console.error('Error loading data from localStorage:', e);
            }
        }

        function saveAllDataToLocalStorage() {
            localStorage.setItem('assets', JSON.stringify(assets));
            localStorage.setItem('incidents', JSON.stringify(incidents));
            localStorage.setItem('maintenance', JSON.stringify(maintenance));
            localStorage.setItem('passwords', JSON.stringify(passwords));
            if (masterKey) {
                localStorage.setItem('masterKey', masterKey);
            }
            localStorage.setItem('recentFiles', JSON.stringify(recentFiles));
        }

        function addRecentFile(filename) {
            // Agregar el archivo a la lista de recientes (m√°ximo 10)
            recentFiles = recentFiles.filter(file => file !== filename);
            recentFiles.unshift(filename);
            recentFiles = recentFiles.slice(0, 10);

            localStorage.setItem('recentFiles', JSON.stringify(recentFiles));
            loadRecentFiles();
        }

        function loadRecentFiles() {
            const recentFilesContainer = document.getElementById('recentFiles');
            if (recentFiles.length === 0) {
                recentFilesContainer.innerHTML = '<p>No hay archivos recientes</p>';
                return;
            }

            recentFilesContainer.innerHTML = `
                <ul style="list-style: none; padding: 0;">
                    ${recentFiles.map(file => `
                        <li style="padding: 8px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <span><i class="fas fa-file"></i> ${file}</span>
                            <button class="btn btn-secondary" onclick="loadRecentFile('${file}')" style="padding: 4px 8px;">
                                <i class="fas fa-upload"></i> Cargar
                            </button>
                        </li>
                    `).join('')}
                </ul>
            `;
        }

        function loadRecentFile(filename) {
            // Esta funci√≥n es simb√≥lica - en un navegador no podemos acceder directamente a archivos
            // del sistema sin que el usuario los seleccione
            alert('Para cargar un archivo, use el bot√≥n "Cargar Archivo" y seleccione el archivo deseado.');
        }

        function formatDateForFilename(date) {
            return `${date.getFullYear()}${pad(date.getMonth() + 1)}${pad(date.getDate())}_${pad(date.getHours())}${pad(date.getMinutes())}`;
        }

        function pad(num) {
            return num.toString().padStart(2, '0');
        }
        // Funciones para la navegaci√≥n entre pesta√±as
        function showTab(tabName) {
            // Ocultar todas las pesta√±as
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Mostrar la pesta√±a seleccionada
            document.getElementById(tabName).classList.add('active');

            // Actualizar la clase active en los tabs de navegaci√≥n
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Encontrar y activar el tab correspondiente
            document.querySelectorAll('.nav-tab').forEach(tab => {
                if (tab.getAttribute('onclick').includes(tabName)) {
                    tab.classList.add('active');
                }
            });

            // Si es la pesta√±a de contrase√±as y no hay clave maestra, mostrar modal
            if (tabName === 'passwords' && !masterKey) {
                showModal('masterKeyModal');
            }

            // Si es la pesta√±a de contrase√±as y hay clave maestra, pero no se ha ingresado, pedirla
            if (tabName === 'passwords' && masterKey && !sessionStorage.getItem('masterKeyVerified')) {
                showModal('enterMasterKeyModal');
            }

            // Recargar datos espec√≠ficos de la pesta√±a
            if (tabName === 'dashboard') {
                loadDashboardData();
            } else if (tabName === 'assets') {
                loadAssetsTable();
            } else if (tabName === 'incidents') {
                loadIncidentsTable();
            } else if (tabName === 'maintenance') {
                loadMaintenanceTable();
            } else if (tabName === 'passwords') {
                loadPasswordsTable();
            } else if (tabName === 'backup') {
                loadRecentFiles();
            }
        }

        // Funciones para el Dashboard
        function loadDashboardData() {
            // Actualizar m√©tricas
            document.getElementById('totalAssets').textContent = assets.length;
            document.getElementById('activeIncidents').textContent = incidents.filter(i => i.status === 'Abierto' || i.status === 'En Progreso').length;
            document.getElementById('expiredLicenses').textContent = assets.filter(a => a.type === 'Licencia' && new Date(a.warranty) < new Date()).length;
            document.getElementById('maintenanceDue').textContent = maintenance.filter(m => m.status === 'Programado' && new Date(m.date) <= new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)).length;
            document.getElementById('totalPasswords').textContent = passwords.length;

            // Cargar gr√°ficos
            renderIncidentsChart();
            renderIncidentsTrendChart();
            loadAlerts();

            // Guardar datos en localStorage como respaldo
            saveAllDataToLocalStorage();
        }

        function renderIncidentsChart() {
            const ctx = document.getElementById('incidentsChart').getContext('2d');
            const areas = [...new Set(incidents.map(i => i.area))];
            const data = areas.map(area => incidents.filter(i => i.area === area).length);

            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: areas,
                    datasets: [{
                        data: data,
                        backgroundColor: ['#3b82f6', '#ef4444', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899', '#06b6d4']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        function renderIncidentsTrendChart() {
            const ctx = document.getElementById('incidentsTrendChart').getContext('2d');
            const last6Months = [...Array(6)].map((_, i) => {
                const d = new Date();
                d.setMonth(d.getMonth() - i);
                return d.toLocaleString('default', { month: 'short' });
            }).reverse();

            const monthlyData = last6Months.map(month => {
                return incidents.filter(i => {
                    const incidentDate = new Date(i.date);
                    return incidentDate.toLocaleString('default', { month: 'short' }) === month;
                }).length;
            });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last6Months,
                    datasets: [{
                        label: 'Incidentes',
                        data: monthlyData,
                        borderColor: '#3b82f6',
                        tension: 0.1,
                        fill: true,
                        backgroundColor: 'rgba(59, 130, 246, 0.1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function loadAlerts() {
            const alertsContainer = document.getElementById('alertsContainer');
            alertsContainer.innerHTML = '';

            // Alertas de garant√≠as pr√≥ximas a vencer
            const expiringWarranties = assets.filter(a => {
                if (!a.warranty) return false;
                const warrantyDate = new Date(a.warranty);
                const daysDiff = Math.floor((warrantyDate - new Date()) / (1000 * 60 * 60 * 24));
                return daysDiff > 0 && daysDiff <= 30;
            });

            if (expiringWarranties.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'alert';
                alert.innerHTML = `
                    <p><i class="fas fa-exclamation-triangle"></i> <strong>${expiringWarranties.length} garant√≠a(s) pr√≥xima(s) a vencer</strong></p>
                    <ul>
                        ${expiringWarranties.map(a => `<li>${a.name} - Vence: ${new Date(a.warranty).toLocaleDateString()}</li>`).join('')}
                    </ul>
                `;
                alertsContainer.appendChild(alert);
            }

            // Alertas de incidentes de alta prioridad
            const highPriorityIncidents = incidents.filter(i => i.priority === 'Alta' || i.priority === 'Cr√≠tica');

            if (highPriorityIncidents.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'alert';
                alert.innerHTML = `
                    <p><i class="fas fa-exclamation-circle"></i> <strong>${highPriorityIncidents.length} incidente(s) de alta prioridad</strong></p>
                    <ul>
                        ${highPriorityIncidents.map(i => `<li>${i.title} - ${i.area}</li>`).join('')}
                    </ul>
                `;
                alertsContainer.appendChild(alert);
            }

            // Alertas de mantenimientos pendientes
            const pendingMaintenance = maintenance.filter(m => m.status === 'Programado' && new Date(m.date) <= new Date());

            if (pendingMaintenance.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'alert';
                alert.innerHTML = `
                    <p><i class="fas fa-tools"></i> <strong>${pendingMaintenance.length} mantenimiento(s) pendiente(s)</strong></p>
                    <ul>
                        ${pendingMaintenance.map(m => `<li>${m.asset} - ${m.type}</li>`).join('')}
                    </ul>
                `;
                alertsContainer.appendChild(alert);
            }

            if (alertsContainer.children.length === 0) {
                alertsContainer.innerHTML = '<p>No hay alertas importantes en este momento.</p>';
            }
        }

        // Funciones para la gesti√≥n de activos
        function loadAssetsTable() {
            const tbody = document.getElementById('assetsTableBody');
            tbody.innerHTML = '';

            assets.forEach(asset => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${asset.name}</td>
                    <td>${asset.type}</td>
                    <td>${asset.area}</td>
                    <td>${asset.serial || '-'}</td>
                    <td>${asset.warranty ? new Date(asset.warranty).toLocaleDateString() : '-'}</td>
                    <td>${getWarrantyStatus(asset.warranty)}</td>
                    <td class="action-buttons">
                        <button class="action-btn edit-btn" onclick="editAsset(${asset.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" onclick="deleteAsset(${asset.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function getWarrantyStatus(warrantyDate) {
            if (!warrantyDate) return 'Sin garant√≠a';

            const today = new Date();
            const warranty = new Date(warrantyDate);
            const diffTime = warranty - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays < 0) return 'Vencida';
            if (diffDays <= 30) return 'Pr√≥xima a vencer';
            return 'Vigente';
        }

        function handleAssetSubmit(e) {
            e.preventDefault();

            const assetId = document.getElementById('assetId').value;
            const assetData = {
                name: document.getElementById('assetName').value,
                type: document.getElementById('assetType').value,
                area: document.getElementById('assetArea').value,
                serial: document.getElementById('assetSerial').value,
                purchaseDate: document.getElementById('assetPurchaseDate').value,
                warranty: document.getElementById('assetWarranty').value,
                notes: document.getElementById('assetNotes').value
            };

            if (assetId) {
                // Editar activo existente
                const index = assets.findIndex(a => a.id == assetId);
                if (index !== -1) {
                    assets[index] = { ...assets[index], ...assetData };
                }
            } else {
                // Agregar nuevo activo
                assetData.id = Date.now();
                assetData.dateAdded = new Date().toISOString();
                assets.push(assetData);
            }

            // Guardar en localStorage
            saveAllDataToLocalStorage();

            // Recargar tabla y limpiar formulario
            loadAssetsTable();
            clearAssetForm();

            // Actualizar dashboard si est√° visible
            if (document.getElementById('dashboard').classList.contains('active')) {
                loadDashboardData();
            }
        }

        function editAsset(id) {
            const asset = assets.find(a => a.id === id);
            if (!asset) return;

            document.getElementById('assetId').value = asset.id;
            document.getElementById('assetName').value = asset.name;
            document.getElementById('assetType').value = asset.type;
            document.getElementById('assetArea').value = asset.area;
            document.getElementById('assetSerial').value = asset.serial || '';
            document.getElementById('assetPurchaseDate').value = asset.purchaseDate || '';
            document.getElementById('assetWarranty').value = asset.warranty || '';
            document.getElementById('assetNotes').value = asset.notes || '';

            document.getElementById('assetSubmitBtn').textContent = 'Actualizar Activo';
            document.getElementById('assetCancelBtn').classList.remove('hidden');

            // Scroll to form
            document.getElementById('assetForm').scrollIntoView({ behavior: 'smooth' });
        }

        function deleteAsset(id) {
            if (confirm('¬øEst√° seguro de que desea eliminar este activo?')) {
                assets = assets.filter(a => a.id !== id);
                localStorage.setItem('assets', JSON.stringify(assets));
                loadAssetsTable();

                // Actualizar dashboard si est√° visible
                if (document.getElementById('dashboard').classList.contains('active')) {
                    loadDashboardData();
                }
            }
        }

        function clearAssetForm() {
            document.getElementById('assetForm').reset();
            document.getElementById('assetId').value = '';
            document.getElementById('assetSubmitBtn').textContent = 'Agregar Activo';
            document.getElementById('assetCancelBtn').classList.add('hidden');
        }

        function cancelAssetEdit() {
            clearAssetForm();
        }

        function filterAssets() {
            const searchTerm = document.getElementById('assetSearch').value.toLowerCase();
            const rows = document.getElementById('assetsTableBody').getElementsByTagName('tr');

            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            }
        }

        // Funciones para la gesti√≥n de incidentes (similares a las de activos)
        function loadIncidentsTable() {
            const tbody = document.getElementById('incidentsTableBody');
            tbody.innerHTML = '';

            incidents.forEach(incident => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${incident.id}</td>
                    <td>${incident.title}</td>
                    <td>${incident.area}</td>
                    <td>${incident.type}</td>
                    <td><span class="priority-${incident.priority.toLowerCase()}">${incident.priority}</span></td>
                    <td>${incident.status}</td>
                    <td>${new Date(incident.date).toLocaleDateString()}</td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" onclick="viewIncident(${incident.id})"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit-btn" onclick="editIncident(${incident.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" onclick="deleteIncident(${incident.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function handleIncidentSubmit(e) {
            e.preventDefault();

            const incidentId = document.getElementById('incidentId').value;
            const incidentData = {
                title: document.getElementById('incidentTitle').value,
                area: document.getElementById('incidentArea').value,
                type: document.getElementById('incidentType').value,
                priority: document.getElementById('incidentPriority').value,
                reporter: document.getElementById('incidentReporter').value,
                status: document.getElementById('incidentStatus').value,
                description: document.getElementById('incidentDescription').value,
                resolution: document.getElementById('incidentResolution').value
            };

            if (incidentId) {
                // Editar incidente existente
                const index = incidents.findIndex(i => i.id == incidentId);
                if (index !== -1) {
                    incidents[index] = { ...incidents[index], ...incidentData };
                }
            } else {
                // Agregar nuevo incidente
                incidentData.id = Date.now();
                incidentData.date = new Date().toISOString();
                incidents.push(incidentData);
            }

            // Guardar en localStorage
            localStorage.setItem('incidents', JSON.stringify(incidents));

            // Recargar tabla y limpiar formulario
            loadIncidentsTable();
            clearIncidentForm();

            // Actualizar dashboard si est√° visible
            if (document.getElementById('dashboard').classList.contains('active')) {
                loadDashboardData();
            }
        }

        function editIncident(id) {
            const incident = incidents.find(i => i.id === id);
            if (!incident) return;

            document.getElementById('incidentId').value = incident.id;
            document.getElementById('incidentTitle').value = incident.title;
            document.getElementById('incidentArea').value = incident.area;
            document.getElementById('incidentType').value = incident.type;
            document.getElementById('incidentPriority').value = incident.priority;
            document.getElementById('incidentReporter').value = incident.reporter;
            document.getElementById('incidentStatus').value = incident.status;
            document.getElementById('incidentDescription').value = incident.description;
            document.getElementById('incidentResolution').value = incident.resolution || '';

            document.getElementById('incidentSubmitBtn').textContent = 'Actualizar Incidente';
            document.getElementById('incidentCancelBtn').classList.remove('hidden');

            // Scroll to form
            document.getElementById('incidentForm').scrollIntoView({ behavior: 'smooth' });
        }

        function viewIncident(id) {
            const incident = incidents.find(i => i.id === id);
            if (!incident) return;

            alert(`
                Incidente: ${incident.title}
                √Årea: ${incident.area}
                Tipo: ${incident.type}
                Prioridad: ${incident.priority}
                Reportado por: ${incident.reporter}
                Estado: ${incident.status}
                Descripci√≥n: ${incident.description}
                Resoluci√≥n: ${incident.resolution || 'Sin resoluci√≥n a√∫n'}
                Fecha: ${new Date(incident.date).toLocaleDateString()}
            `);
        }

        function deleteIncident(id) {
            if (confirm('¬øEst√° seguro de que desea eliminar este incidente?')) {
                incidents = incidents.filter(i => i.id !== id);
                localStorage.setItem('incidents', JSON.stringify(incidents));
                loadIncidentsTable();

                // Actualizar dashboard si est√° visible
                if (document.getElementById('dashboard').classList.contains('active')) {
                    loadDashboardData();
                }
            }
        }

        function clearIncidentForm() {
            document.getElementById('incidentForm').reset();
            document.getElementById('incidentId').value = '';
            document.getElementById('incidentStatus').value = 'Abierto';
            document.getElementById('incidentSubmitBtn').textContent = 'Registrar Incidente';
            document.getElementById('incidentCancelBtn').classList.add('hidden');
        }

        function cancelIncidentEdit() {
            clearIncidentForm();
        }

        function filterIncidents() {
            const searchTerm = document.getElementById('incidentSearch').value.toLowerCase();
            const rows = document.getElementById('incidentsTableBody').getElementsByTagName('tr');

            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            }
        }

        // Funciones para la gesti√≥n de mantenimiento (similares a las anteriores)
        function loadMaintenanceTable() {
            const tbody = document.getElementById('maintenanceTableBody');
            tbody.innerHTML = '';

            maintenance.forEach(item => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${item.asset}</td>
                    <td>${item.type}</td>
                    <td>${new Date(item.date).toLocaleDateString()}</td>
                    <td>${item.status}</td>
                    <td>${item.description}</td>
                    <td class="action-buttons">
                        <button class="action-btn edit-btn" onclick="editMaintenance(${item.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" onclick="deleteMaintenance(${item.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function handleMaintenanceSubmit(e) {
            e.preventDefault();

            const maintenanceId = document.getElementById('maintenanceId').value;
            const maintenanceData = {
                asset: document.getElementById('maintenanceAsset').value,
                type: document.getElementById('maintenanceType').value,
                date: document.getElementById('maintenanceDate').value,
                description: document.getElementById('maintenanceDescription').value,
                status: document.getElementById('maintenanceStatus').value
            };

            if (maintenanceId) {
                // Editar mantenimiento existente
                const index = maintenance.findIndex(m => m.id == maintenanceId);
                if (index !== -1) {
                    maintenance[index] = { ...maintenance[index], ...maintenanceData };
                }
            } else {
                // Agregar nuevo mantenimiento
                maintenanceData.id = Date.now();
                maintenance.push(maintenanceData);
            }

            // Guardar en localStorage
            localStorage.setItem('maintenance', JSON.stringify(maintenance));

            // Recargar tabla y limpiar formulario
            loadMaintenanceTable();
            clearMaintenanceForm();

            // Actualizar dashboard si est√° visible
            if (document.getElementById('dashboard').classList.contains('active')) {
                loadDashboardData();
            }
        }

        function editMaintenance(id) {
            const item = maintenance.find(m => m.id === id);
            if (!item) return;

            document.getElementById('maintenanceId').value = item.id;
            document.getElementById('maintenanceAsset').value = item.asset;
            document.getElementById('maintenanceType').value = item.type;
            document.getElementById('maintenanceDate').value = item.date;
            document.getElementById('maintenanceDescription').value = item.description;
            document.getElementById('maintenanceStatus').value = item.status;

            document.getElementById('maintenanceSubmitBtn').textContent = 'Actualizar Mantenimiento';
            document.getElementById('maintenanceCancelBtn').classList.remove('hidden');

            // Scroll to form
            document.getElementById('maintenanceForm').scrollIntoView({ behavior: 'smooth' });
        }

        function deleteMaintenance(id) {
            if (confirm('¬øEst√° seguro de que desea eliminar este mantenimiento?')) {
                maintenance = maintenance.filter(m => m.id !== id);
                localStorage.setItem('maintenance', JSON.stringify(maintenance));
                loadMaintenanceTable();

                // Actualizar dashboard si est√° visible
                if (document.getElementById('dashboard').classList.contains('active')) {
                    loadDashboardData();
                }
            }
        }

        function clearMaintenanceForm() {
            document.getElementById('maintenanceForm').reset();
            document.getElementById('maintenanceId').value = '';
            document.getElementById('maintenanceStatus').value = 'Programado';
            document.getElementById('maintenanceSubmitBtn').textContent = 'Programar Mantenimiento';
            document.getElementById('maintenanceCancelBtn').classList.add('hidden');
        }

        function cancelMaintenanceEdit() {
            clearMaintenanceForm();
        }

        function filterMaintenance() {
            const searchTerm = document.getElementById('maintenanceSearch').value.toLowerCase();
            const rows = document.getElementById('maintenanceTableBody').getElementsByTagName('tr');

            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            }
        }

        // Funciones para la gesti√≥n de contrase√±as
        function loadPasswordsTable() {
            const tbody = document.getElementById('passwordsTableBody');
            tbody.innerHTML = '';

            // Verificar si las contrase√±as est√°n desbloqueadas
            if (!sessionStorage.getItem('masterKeyVerified')) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 20px;">
                            <i class="fas fa-lock" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                            <p>Las contrase√±as est√°n bloqueadas. Ingrese la clave maestra para verlas.</p>
                            <button class="btn" onclick="showModal('enterMasterKeyModal')"><i class="fas fa-unlock"></i> Desbloquear Contrase√±as</button>
                        </td>
                    </tr>
                `;
                return;
            }

            passwords.forEach(password => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${password.platform}</td>
                    <td>${password.username}</td>
                    <td><span class="category-badge category-${password.category}">${getCategoryName(password.category)}</span></td>
                    <td>
                        <div class="password-container">
                            <input type="password" value="${decryptPassword(password.password)}" readonly class="password-field" id="password-${password.id}">
                            <span class="toggle-password" onclick="togglePasswordVisibility('password-${password.id}')">
                                <i class="fas fa-eye"></i>
                            </span>
                        </div>
                    </td>
                    <td class="action-buttons">
                        <button class="action-btn view-btn" onclick="viewPassword(${password.id})"><i class="fas fa-eye"></i></button>
                        <button class="action-btn edit-btn" onclick="editPassword(${password.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" onclick="deletePassword(${password.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            if (passwords.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 20px;">
                            <i class="fas fa-key" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                            <p>No hay contrase√±as guardadas. Agregue su primera contrase√±a.</p>
                        </td>
                    </tr>
                `;
            }
        }

        function getCategoryName(category) {
            const categories = {
                'email': 'Email',
                'social': 'Redes Sociales',
                'work': 'Trabajo',
                'finance': 'Finanzas',
                'entertainment': 'Entretenimiento',
                'other': 'Otro'
            };
            return categories[category] || category;
        }

        function handlePasswordSubmit(e) {
            e.preventDefault();

            // Verificar que la clave maestra est√© establecida
            if (!masterKey) {
                alert('Primero debe establecer una clave maestra');
                showModal('masterKeyModal');
                return;
            }

            // Verificar que la clave maestra est√© verificada para esta sesi√≥n
            if (!sessionStorage.getItem('masterKeyVerified')) {
                alert('Debe verificar su clave maestra primero');
                showModal('enterMasterKeyModal');
                return;
            }

            const passwordId = document.getElementById('passwordId').value;
            const passwordData = {
                platform: document.getElementById('passwordPlatform').value,
                username: document.getElementById('passwordUsername').value,
                category: document.getElementById('passwordCategory').value,
                url: document.getElementById('passwordUrl').value,
                notes: document.getElementById('passwordNotes').value,
                password: encryptPassword(document.getElementById('passwordValue').value)
            };

            if (passwordId) {
                // Editar contrase√±a existente
                const index = passwords.findIndex(p => p.id == passwordId);
                if (index !== -1) {
                    passwords[index] = { ...passwords[index], ...passwordData };
                }
            } else {
                // Agregar nueva contrase√±a
                passwordData.id = Date.now();
                passwordData.dateAdded = new Date().toISOString();
                passwords.push(passwordData);
            }

            // Guardar en localStorage
            localStorage.setItem('passwords', JSON.stringify(passwords));

            // Recargar tabla y limpiar formulario
            loadPasswordsTable();
            clearPasswordForm();

            // Actualizar dashboard si est√° visible
            if (document.getElementById('dashboard').classList.contains('active')) {
                loadDashboardData();
            }
        }

        function encryptPassword(password) {
            // En un entorno real, aqu√≠ se usar√≠a una librer√≠a de encriptaci√≥n
            // Para este ejemplo, usamos una encriptaci√≥n b√°sica con btoa
            return btoa(password);
        }

        function decryptPassword(encryptedPassword) {
            // Desencriptar la contrase√±a
            try {
                return atob(encryptedPassword);
            } catch (e) {
                return 'Error al desencriptar';
            }
        }

        function viewPassword(id) {
            const password = passwords.find(p => p.id === id);
            if (!password) return;

            alert(`
                Plataforma: ${password.platform}
                Usuario: ${password.username}
                Contrase√±a: ${decryptPassword(password.password)}
                Categor√≠a: ${getCategoryName(password.category)}
                URL: ${password.url || 'No especificada'}
                Notas: ${password.notes || 'No hay notas'}
                Fecha de agregado: ${new Date(password.dateAdded).toLocaleDateString()}
            `);
        }

        function editPassword(id) {
            const password = passwords.find(p => p.id === id);
            if (!password) return;

            document.getElementById('passwordId').value = password.id;
            document.getElementById('passwordPlatform').value = password.platform;
            document.getElementById('passwordUsername').value = password.username;
            document.getElementById('passwordCategory').value = password.category;
            document.getElementById('passwordUrl').value = password.url || '';
            document.getElementById('passwordNotes').value = password.notes || '';
            document.getElementById('passwordValue').value = decryptPassword(password.password);

            document.getElementById('passwordSubmitBtn').textContent = 'Actualizar Contrase√±a';
            document.getElementById('passwordCancelBtn').classList.remove('hidden');

            // Actualizar la fortaleza de la contrase√±a
            checkPasswordStrength();

            // Scroll to form
            document.getElementById('passwordForm').scrollIntoView({ behavior: 'smooth' });
        }

        function deletePassword(id) {
            if (confirm('¬øEst√° seguro de que desea eliminar esta contrase√±a?')) {
                passwords = passwords.filter(p => p.id !== id);
                localStorage.setItem('passwords', JSON.stringify(passwords));
                loadPasswordsTable();

                // Actualizar dashboard si est√° visible
                if (document.getElementById('dashboard').classList.contains('active')) {
                    loadDashboardData();
                }
            }
        }

        function clearPasswordForm() {
            document.getElementById('passwordForm').reset();
            document.getElementById('passwordId').value = '';
            document.getElementById('passwordSubmitBtn').textContent = 'Guardar Contrase√±a';
            document.getElementById('passwordCancelBtn').classList.add('hidden');
            document.getElementById('passwordStrength').className = 'password-strength';
        }

        function cancelPasswordEdit() {
            clearPasswordForm();
        }

        function filterPasswords() {
            const searchTerm = document.getElementById('passwordSearch').value.toLowerCase();
            const categoryFilter = document.getElementById('passwordCategoryFilter').value;
            const rows = document.getElementById('passwordsTableBody').getElementsByTagName('tr');

            for (let row of rows) {
                const text = row.textContent.toLowerCase();
                const categoryMatch = categoryFilter ? row.textContent.includes(getCategoryName(categoryFilter)) : true;
                row.style.display = (text.includes(searchTerm) && categoryMatch) ? '' : 'none';
            }
        }

        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.nextElementSibling.querySelector('i');

            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        function checkPasswordStrength() {
            const password = document.getElementById('passwordValue').value;
            const strengthBar = document.getElementById('passwordStrength');

            if (!password) {
                strengthBar.className = 'password-strength';
                return;
            }

            // Calcular fortaleza de la contrase√±a
            let strength = 0;

            // Longitud
            if (password.length >= 8) strength++;
            if (password.length >= 12) strength++;

            // Complejidad
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;

            // Actualizar la barra de fortaleza
            if (strength <= 2) {
                strengthBar.className = 'password-strength strength-weak';
            } else if (strength <= 4) {
                strengthBar.className = 'password-strength strength-medium';
            } else {
                strengthBar.className = 'password-strength strength-strong';
            }
        }

        function generateSecurePassword() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()';
            let password = '';

            for (let i = 0; i < 16; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }

            document.getElementById('passwordValue').value = password;
            document.getElementById('passwordValue').type = 'text';

            // Actualizar la fortaleza de la contrase√±a
            checkPasswordStrength();
        }

        // Funciones para la clave maestra
        function setMasterKey() {
            const key = document.getElementById('masterKeyInput').value;
            const confirmKey = document.getElementById('masterKeyConfirm').value;

            if (!key) {
                alert('La clave maestra no puede estar vac√≠a');
                return;
            }

            if (key !== confirmKey) {
                alert('Las claves no coinciden');
                return;
            }

            if (key.length < 8) {
                alert('La clave maestra debe tener al menos 8 caracteres');
                return;
            }

            // Guardar la clave maestra (en un entorno real, esto se har√≠a de forma m√°s segura)
            masterKey = key;
            localStorage.setItem('masterKey', masterKey);
            sessionStorage.setItem('masterKeyVerified', 'true');

            // Cerrar el modal
            closeModal('masterKeyModal');

            // Recargar la tabla de contrase√±as
            loadPasswordsTable();

            alert('Clave maestra establecida correctamente');
        }

        function verifyMasterKey() {
            const key = document.getElementById('enterMasterKeyInput').value;

            if (key === masterKey) {
                sessionStorage.setItem('masterKeyVerified', 'true');
                closeModal('enterMasterKeyModal');
                loadPasswordsTable();
            } else {
                alert('Clave maestra incorrecta');
            }
        }

        // Funciones para modales
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Funciones para reportes
        function generateReport() {
            const reportType = document.getElementById('reportType').value;
            const reportPeriod = document.getElementById('reportPeriod').value;
            let reportContent = '';

            if (reportType === 'assets') {
                reportContent = `
                    <h4>Inventario de Activos</h4>
                    <p>Total de activos: ${assets.length}</p>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Tipo</th>
                                    <th>√Årea</th>
                                    <th>N√∫mero de Serie</th>
                                    <th>Fecha de Compra</th>
                                    <th>Garant√≠a</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${assets.map(asset => `
                                    <tr>
                                        <td>${asset.name}</td>
                                        <td>${asset.type}</td>
                                        <td>${asset.area}</td>
                                        <td>${asset.serial || '-'}</td>
                                        <td>${asset.purchaseDate || '-'}</td>
                                        <td>${asset.warranty ? new Date(asset.warranty).toLocaleDateString() : '-'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } else if (reportType === 'incidents') {
                reportContent = `
                    <h4>Reporte de Incidentes</h4>
                    <p>Total de incidentes: ${incidents.length}</p>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>T√≠tulo</th>
                                    <th>√Årea</th>
                                    <th>Tipo</th>
                                    <th>Prioridad</th>
                                    <th>Estado</th>
                                    <th>Fecha</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${incidents.map(incident => `
                                    <tr>
                                        <td>${incident.id}</td>
                                        <td>${incident.title}</td>
                                        <td>${incident.area}</td>
                                        <td>${incident.type}</td>
                                        <td>${incident.priority}</td>
                                        <td>${incident.status}</td>
                                        <td>${new Date(incident.date).toLocaleDateString()}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } else if (reportType === 'passwords') {
                // Verificar clave maestra para reporte de contrase√±as
                if (!sessionStorage.getItem('masterKeyVerified')) {
                    alert('Debe verificar su clave maestra para generar el reporte de contrase√±as');
                    showModal('enterMasterKeyModal');
                    return;
                }

                reportContent = `
                    <h4>Reporte de Contrase√±as</h4>
                    <p>Total de contrase√±as: ${passwords.length}</p>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Plataforma</th>
                                    <th>Usuario</th>
                                    <th>Categor√≠a</th>
                                    <th>Contrase√±a</th>
                                    <th>URL</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${passwords.map(password => `
                                    <tr>
                                        <td>${password.platform}</td>
                                        <td>${password.username}</td>
                                        <td>${getCategoryName(password.category)}</td>
                                        <td>${decryptPassword(password.password)}</td>
                                        <td>${password.url || '-'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } else {
                reportContent = '<p>Selecciona un tipo de reporte v√°lido.</p>';
            }

            document.getElementById('reportContent').innerHTML = reportContent;
        }

        function exportToExcel() {
            const reportType = document.getElementById('reportType').value;
            let data = [];
            let fileName = '';

            if (reportType === 'assets') {
                data = assets.map(asset => ({
                    'Nombre': asset.name,
                    'Tipo': asset.type,
                    '√Årea': asset.area,
                    'N√∫mero de Serie': asset.serial || '',
                    'Fecha de Compra': asset.purchaseDate || '',
                    'Garant√≠a': asset.warranty || ''
                }));
                fileName = 'inventario_activos.xlsx';
            } else if (reportType === 'incidents') {
                data = incidents.map(incident => ({
                    'ID': incident.id,
                    'T√≠tulo': incident.title,
                    '√Årea': incident.area,
                    'Tipo': incident.type,
                    'Prioridad': incident.priority,
                    'Estado': incident.status,
                    'Fecha': new Date(incident.date).toLocaleDateString(),
                    'Descripci√≥n': incident.description,
                    'Resoluci√≥n': incident.resolution || ''
                }));
                fileName = 'reporte_incidentes.xlsx';
            } else if (reportType === 'passwords') {
                // Verificar clave maestra para exportar contrase√±as
                if (!sessionStorage.getItem('masterKeyVerified')) {
                    alert('Debe verificar su clave maestra para exportar contrase√±as');
                    showModal('enterMasterKeyModal');
                    return;
                }

                data = passwords.map(password => ({
                    'Plataforma': password.platform,
                    'Usuario': password.username,
                    'Categor√≠a': getCategoryName(password.category),
                    'Contrase√±a': decryptPassword(password.password),
                    'URL': password.url || '',
                    'Notas': password.notes || ''
                }));
                fileName = 'contrase√±as.xlsx';
            } else {
                alert('Selecciona un tipo de reporte v√°lido para exportar.');
                return;
            }

            if (data.length === 0) {
                alert('No hay datos para exportar.');
                return;
            }

            // Crear libro de Excel
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Reporte');

            // Exportar a Excel
            XLSX.writeFile(wb, fileName);
        }
    </script>
</body>
</html>
